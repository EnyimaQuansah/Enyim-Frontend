<%- include("../../partials/header") %>
<div class="container my-4">
  <h1>Edit Product</h1>
  <form action="/products/<%= product._id %>/edit" method="POST" enctype="multipart/form-data">
    <!-- Product Title -->
    <div class="mb-3">
      <label for="title" class="form-label">Product Title</label>
      <input
        type="text"
        class="form-control"
        id="title"
        name="title"
        value="<%= product.title %>"
        required
      />
    </div>

    <!-- Description -->
    <div class="mb-3">
      <label for="description" class="form-label">Description</label>
      <textarea
        class="form-control"
        id="description"
        name="description"
        rows="4"
        required
      ><%= product.description %></textarea>
    </div>

    <!-- Category -->
    <div class="mb-3">
      <label for="category" class="form-label">Category</label>
      <select class="form-select" id="category" name="category_id" required>
        <% categories.forEach(category => { %>
          <option value="<%= category._id %>" <%= product.category_id.toString() === category._id.toString() ? "selected" : "" %>>
            <%= category.name %>
          </option>
        <% }); %>
      </select>
    </div>

    <!-- Price -->
    <div class="mb-3">
      <label for="price" class="form-label">Price</label>
      <input
        type="number"
        step="0.01"
        class="form-control"
        id="price"
        name="price"
        value="<%= product.price %>"
        required
      />
    </div>

    <!-- Quantity -->
    <div class="mb-3">
      <label for="quantity" class="form-label">Quantity</label>
      <input
        type="number"
        class="form-control"
        id="quantity"
        name="quantity"
        value="<%= product.quantity %>"
        required
      />
    </div>

    <!-- Image Upload Section -->
    <div class="mb-3">
      <label for="image" class="form-label">Image</label>
      <p class="text-muted">Current Image: <%= product.image ? product.image : "None" %></p>
      <img src="<%= product.image %>" alt="Current Image" class="img-thumbnail mb-3" style="max-width: 200px;" />
      <p class="text-muted">You can either upload a new image file or provide a new image URL.</p>
      <input
        type="file"
        class="form-control mb-2"
        id="image"
        name="imageFile"
        accept="image/*"
      />
      <input
        type="text"
        class="form-control"
        id="image-url"
        name="image"
        placeholder="Or provide an image URL"
        value="<%= product.image %>"
      />
    </div>

    <!-- Submit Button -->
    <button type="submit" class="btn btn-warning">Update Product</button>
  </form>
</div>
<%- include("../../partials/footer") %>
